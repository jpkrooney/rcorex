test_that("logsumexp4D works", {
    expect_equal( logSumExp4D(log_joint_pxi_y = log_marg_x_4d_gaussian),
                  structure(c(0.83751126511956, 1.09585532275634, 0.83751126511956,
                              1.09585532275634, 0.809760701758075, 1.08203351489187, 0.809760701758075,
                              1.08203351489187, 0.83751126511956, 1.09585532275634, 0.83751126511956,
                              1.09585532275634, 0.809760701758075, 1.08203351489187, 0.809760701758075,
                              1.08203351489187, 0.83751126511956, 1.09585532275634, 0.83751126511956,
                              1.09585532275634, 0.809760701758075, 1.08203351489187, 0.809760701758075,
                              1.08203351489187, 0.804756968947994, 1.0893258840592, 0.830050865349458,
                              1.08976659663234, 0.804756968947994, 1.0893258840592, 0.830050865349458,
                              1.08976659663234, 0.804756968947994, 1.0893258840592, 0.830050865349458,
                              1.08976659663234, 0.804756968947994, 1.0893258840592, 0.830050865349458,
                              1.08976659663234), .Dim = c(2L, 4L, 5L)) )
})
